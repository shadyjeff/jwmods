"use strict";(self.webpackChunkjwplayer=self.webpackChunkjwplayer||[]).push([[977],{3328:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(6103),c=i(8377);const a={TIT2:"title",TT2:"title",WXXX:"url",TPE1:"artist",TP1:"artist",TALB:"album",TAL:"album"},l=(e,t)=>{var i=e.length;let s,a,r,n="",d=t||0;for(;d<i;)if(0!==(s=e[d++])&&3!==s)switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(s);break;case 12:case 13:a=e[d++],n+=String.fromCharCode((31&s)<<6|63&a);break;case 14:a=e[d++],r=e[d++],n+=String.fromCharCode((15&s)<<12|(63&a)<<6|(63&r)<<0)}return n},h=e=>{e=(t=>{let i="0x";for(let e=0;e<t.length;e++)t[e]<16&&(i+="0"),i+=t[e].toString(16);return parseInt(i,16)})(e);return 127&e|(32512&e)>>1|(8323072&e)>>2|(2130706432&e)>>3};var u=i(8348),m=i(1643),r=i(6042);function T(e){const t=e.target,{activeCues:i,cues:s}=t,a=t._id,r=this._cues,n=this._activeCues;if(null!=s&&s.length){const e=r[a];r[a]=Array.prototype.slice.call(s),this.parseNativeID3Cues(s,e)}else delete r[a];if(null!=i&&i.length){const e=n[a],t=n[a]=Array.prototype.slice.call(i);this.triggerActiveCues(t,e)}else delete n[a]}const n=(i,e,s)=>{null!=e&&e.length&&(0,r.S6)(e,function(t){var e=t._id||"";if(s&&(t._id=void 0),!u.Browser.ie&&!u.Browser.safari||!i||!/^(native|subtitle|cc)/.test(e)){if(u.Browser.ie&&"disabled"===t.mode||(t.mode="disabled",t.mode="hidden"),t.cues)for(let e=t.cues.length;e--;)t.removeCue(t.cues[e]);t.embedded||(t.mode="disabled"),t.inuse=!1}})},v=e=>/^native(?:captions|subtitles)/.test(e),g=e=>"captions"===e||"subtitles"===e,k=(t,i,s)=>{if(u.Browser.ie){let e=s;(t||"metadata"===i.kind)&&(e=new window.TextTrackCue(s.startTime,s.endTime,s.text),s.value)&&(e.value=s.value);var a=i,r=e,n=[],d=a.mode,o=(a.mode="hidden",a.cues);if(o)for(let e=o.length-1;0<=e&&o[e].startTime>r.startTime;e--)n.unshift(o[e]),a.removeCue(o[e]);try{a.addCue(r),n.forEach(e=>a.addCue(e))}catch(a){console.error(a)}a.mode=d}else try{i.addCue(s)}catch(t){console.error(t)}},p=(e,t)=>e.startTime===t.startTime&&e.endTime===t.endTime&&e.text===t.text&&e.data===t.data&&JSON.stringify(e.value)===JSON.stringify(t.value),f=e=>{var t=(r=>{const n={};if(!("value"in r)&&"data"in r&&r.data instanceof ArrayBuffer){const n=new Uint8Array(r.data);let t=n.length,e=(r={value:{key:"",data:""}},10);for(;e<14&&e<n.length&&0!==n[e];)r.value.key+=String.fromCharCode(n[e]),e++;let i=19,s=n[i],a=(3!==s&&0!==s||(s=n[++i],t--),0);if(1!==s&&2!==s)for(let e=i+1;e<t;e++)if(0===n[e]){a=e-i;break}var d,o;0<a?(d=l(n.subarray(i,i+=a),0),"PRIV"===r.value.key?("com.apple.streaming.transportStreamTimestamp"===d?(o=1&h(n.subarray(i,i+=4)),o=h(n.subarray(i,i+=4))+(o?4294967296:0),r.value.data=o):r.value.data=l(n,i+1),r.value.info=d):(r.value.info=d,r.value.data=l(n,i+1))):(o=n[i],r.value.data=(1===o||2===o?(e,t)=>{var i=e.length-1;let s="",a=t||0;for(;a<i;)254===e[a]&&255===e[a+1]||(s+=String.fromCharCode((e[a]<<8)+e[a+1])),a+=2;return s}:l)(n,i+1))}if(function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)}(a,r.value.key)&&(n[a[r.value.key]]=r.value.data),r.value.info){let e=n[r.value.key];e!==Object(e)&&(e={},n[r.value.key]=e),e[r.value.info]=r.value.data}else n[r.value.key]=r.value.data;return n})(e);return{metadataType:"id3",metadataTime:e.startTime,metadata:t}},d={_itemTracks:null,_textTracks:null,_currentTextTrackIndex:-1,_tracksById:null,_cuesByTrackId:null,_cachedVTTCues:null,_metaCuesByTextTime:null,_unknownCount:0,_activeCues:null,_cues:null,textTrackChangeHandler:null,addTrackHandler:null,cueChangeHandler:null,renderNatively:!1,_initTextTracks(){this._textTracks=[],this._tracksById={},this._metaCuesByTextTime={},this._cuesByTrackId={},this._cachedVTTCues={},this._cues={},this._activeCues={},this._unknownCount=0},addTracksListener(e,t,i){e&&(this.removeTracksListener(e,t,i),this.instreamMode||(e.addEventListener?e.addEventListener(t,i):e["on"+t]=i))},removeTracksListener(e,t,i){e&&(e.removeEventListener&&i?e.removeEventListener(t,i):e["on"+t]=null)},clearTracks(){(0,s.VS)(this._itemTracks);const t=this["_tracksById"];if(t&&Object.keys(t).forEach(e=>{0===e.indexOf("nativemetadata")&&(e=t[e],this.cueChangeHandler&&e.removeEventListener("cuechange",this.cueChangeHandler),n(this.renderNatively,[e],!0))}),this._itemTracks=null,this._textTracks=null,this._tracksById=null,this._cuesByTrackId=null,this._metaCuesByTextTime=null,this._unknownCount=0,this._currentTextTrackIndex=-1,this._activeCues={},this._cues={},this.renderNatively){const t=this.video.textTracks;this.textTrackChangeHandler&&this.removeTracksListener(t,"change",this.textTrackChangeHandler),n(this.renderNatively,t,!0)}},clearMetaCues(){const{_tracksById:t,_cachedVTTCues:i}=this;t&&i&&Object.keys(t).forEach(e=>{0===e.indexOf("nativemetadata")&&(e=t[e],n(this.renderNatively,[e],!1),e.mode="hidden",e.inuse=!0,e._id)&&(i[e._id]={})})},clearCueData(e){var t=this._cachedVTTCues;null!=t&&t[e]&&(t[e]={},this._tracksById)&&(this._tracksById[e].data=[])},disableTextTrack(){var e,t=this.getCurrentTextTrack();t&&(t.mode="disabled",(e=t._id)&&v(e)||this.renderNatively&&u.OS.iOS)&&(t.mode="hidden")},enableTextTrack(){var e=this.getCurrentTextTrack();e&&(e.mode="showing")},getCurrentTextTrack(){if(this._textTracks)return this._textTracks[this._currentTextTrackIndex]},getSubtitlesTrack(){return this._currentTextTrackIndex},addTextTracks(e){const i=[];return e&&(this._textTracks||this._initTextTracks(),e.forEach(e=>{if(!(e.includedInManifest||e.kind&&!g(e.kind))){const t=this._createTrack(e);this._addTrackToList(t),i.push(t),e.file&&(e.data=[],(0,s.xl)(e,e=>{t.sideloaded=!0,this.addVTTCuesToTrack(t,e)},e=>{this.trigger(m.cM,e)}))}}),null!=this)&&null!=(e=this._textTracks)&&e.length&&this.trigger(m.jt,{tracks:this._textTracks}),i},setTextTracks(i){var e;if(this._currentTextTrackIndex=-1,i){if(this._textTracks){const i=this._tracksById;this._activeCues={},this._cues={},this._unknownCount=0,this._textTracks=this._textTracks.filter(e=>{var t=e._id;return this.renderNatively&&t&&v(t)?(delete i[t],!1):(e.name&&0===e.name.indexOf("Unknown")&&this._unknownCount++,0===t.indexOf("nativemetadata")&&"com.apple.streaming"===e.inBandMetadataTrackDispatchType&&delete i[t],!0)},this)}else this._initTextTracks();if(i.length){let t=0;for(var s=i.length,a=this._tracksById,r=this._cuesByTrackId;t<s;t++){var n,d=i[t];let e=d._id||"";if(!e){if(!1===d.inuse&&g(d.kind)&&this.renderNatively){d._id="native"+d.kind+t;continue}if(g(d.kind)||"metadata"===d.kind){if(e=d._id="native"+d.kind+t,!d.label&&"captions"===d.kind){const i=(0,c._)(d,this._unknownCount);d.name=i.label,this._unknownCount=i.unknownCount}}else e=d._id=(0,c.M)(d,this._textTracks?this._textTracks.length:0);if(a[e])continue;d.inuse=!0}if(d.inuse&&!a[e])if("metadata"===d.kind){d.mode="hidden";const i=this.cueChangeHandler=this.cueChangeHandler||T.bind(this);d.removeEventListener("cuechange",i),d.addEventListener("cuechange",i),a[e]=d}else if(g(d.kind)){const i=d.mode;if(d.mode="hidden",d.cues&&d.cues.length||!d.embedded){if("disabled"===i&&!v(e)||(d.mode=i),r[e]&&!r[e].loaded){for(var o=r[e].cues;n=o.shift();)k(this.renderNatively,d,n);d.mode=i,r[e].loaded=!0}this._addTrackToList(d)}}}}this.renderNatively&&this.addTrackListeners(i),null!=this&&null!=(e=this._textTracks)&&e.length&&this.trigger(m.jt,{tracks:this._textTracks})}},addTrackListeners(e){var t=this.textTrackChangeHandler=this.textTrackChangeHandler||function(){var e=this.video.textTracks,t=(0,r.hX)(e,function(e){return(e.inuse||!e._id)&&g(e.kind)});if(!this._textTracks||function(t){var e=this._textTracks,i=this._tracksById;if(t.length>e.length)return!0;for(let e=0;e<t.length;e++){var s=t[e];if(!s._id||!i[s._id])return!0}return!1}.call(this,t))this.setTextTracks(e);else{let t=-1;for(let e=0;e<this._textTracks.length;e++)if("showing"===this._textTracks[e].mode){t=e;break}t!==this._currentTextTrackIndex&&this.setSubtitlesTrack(t+1)}}.bind(this);this.removeTracksListener(e,"change",t),this.addTracksListener(e,"change",t),(u.Browser.edge&&u.Browser.ie||u.Browser.firefox)&&(t=this.addTrackHandler=this.addTrackHandler||function(e){e=e.track;null!=e&&e._id||this.setTextTracks(this.video.textTracks)}.bind(this),this.removeTracksListener(e,"addtrack",t),this.addTracksListener(e,"addtrack",t))},setupSideloadedTracks(e){var t;this.renderNatively&&((t=(e=e||null)===this._itemTracks)||(0,s.VS)(this._itemTracks),this._itemTracks=e)&&!t&&(this.disableTextTrack(),this._clearSideloadedTextTracks(),this.addTextTracks(e))},setSubtitlesTrack(e){var t;this.renderNatively?this._textTracks&&(0===e&&this._textTracks.forEach(e=>{e.mode=e.embedded?"hidden":"disabled"}),this._currentTextTrackIndex!==e-1)&&(this.disableTextTrack(),this._currentTextTrackIndex=e-1,(t=this.getCurrentTextTrack())&&(t.mode="showing"),this.trigger(m.UF,{currentTrack:this._currentTextTrackIndex+1,tracks:this._textTracks})):this.setCurrentSubtitleTrack&&this.setCurrentSubtitleTrack(e-1)},createCue:(e,t,i)=>new(window.VTTCue||window.TextTrackCue)(e,Math.max(t||0,e+.25),i),addVTTCue(e,t){this._tracksById||this._initTextTracks();var i=e.track||"native"+e.type;let s=this._tracksById[i];var a="captions"===e.type?"Unknown CC":"ID3 Metadata",r=e.cue;if(!s){const t={kind:e.type,_id:i,label:a,default:!1};this.renderNatively||"metadata"===t.kind?((s=this._createTrack(t)).embedded=!0,this.setTextTracks(this.video.textTracks)):s=this.addTextTracks([t])[0]}if(this._cacheVTTCue(s,r,t)){const e=this.renderNatively||"metadata"===s.kind;return e?k(e,s,r):s.data.push(r),r}return null},addVTTCuesToTrack(t,i){if(this.renderNatively){var t=t._id,s=this._tracksById;let e=this._cuesByTrackId;var a,r=s[t];if(r){if(null==(s=e)||null==(s=s[t])||!s.loaded)for(e[t]={cues:i,loaded:!0};a=i.shift();)k(this.renderNatively,r,a)}else(e=e||(this._cuesByTrackId={}))[t]={cues:i,loaded:!1}}},parseNativeID3Cues(a,r){const n=a[a.length-1];if(!r||r.length!==a.length||!n._parsed&&!p(r[r.length-1],n)){var d=[],o=[];let t=-1,i=-1,s;for(let e=0;e<a.length;e++){const n=a[e];if(!n._extended&&Boolean(n.data||n.value)){if(n.startTime!==i||null===n.endTime){s=i,i=n.startTime;const a=d[t],r=(d[++t]=[],o[t]=[],i-s);if(a&&0<r)for(let e=0;e<a.length;e++){const n=a[e];n.endTime=i,n._extended=!0}}d[t].push(n),n._parsed||(o[t].push(n),n.endTime-i<.25&&(n.endTime=i+.25),n._parsed=!0)}}for(let e=0;e<o.length;e++)o[e].length&&o[e].forEach(e=>{e=f(e);this.trigger(m.O1,e)})}},triggerActiveCues(e,i){e=e.filter(t=>{if(null==i||!i.some(e=>p(t,e))){if(t.data)return!0;var e=t.text?(e=>{let t;try{t=JSON.parse(e.text)}catch(e){return null}var i={metadataType:t.metadataType,metadataTime:e.startTime,metadata:t};return t.programDateTime&&(i.programDateTime=t.programDateTime),i})(t):null;if(e)"emsg"===e.metadataType&&(e.metadata=e.metadata||{},e.metadata.messageData=t.value),this.trigger(m.rx,e);else if(t.value)return!0}return!1});e.length&&e.forEach(e=>{e=f(e);this.trigger(m.rx,e)})},ensureMetaTracksActive(){const t=this.video.textTracks,i=t.length;for(let e=0;e<i;e++){const i=t[e];"metadata"===i.kind&&"disabled"===i.mode&&(i.mode="hidden")}},_cacheVTTCue(e,t,i){const s=e.kind,a=e._id,r=this._cachedVTTCues;r[a]||(r[a]={});var n=r[a];let d;switch(s){case"captions":case"subtitles":{d=i||Math.floor(20*t.startTime);const e="_"+(t.line||"auto"),s=Math.floor(20*t.endTime),a=n[d+e]||n[d+1+e]||n[d-1+e];return!(a&&Math.abs(a-s)<=1||(n[d+e]=s,0))}case"metadata":{const e=t.data?new Uint8Array(t.data).join(""):t.text;return!n[d=i||t.startTime+e]&&(n[d]=t.endTime,!0)}default:return!1}},_addTrackToList(e){this._textTracks.push(e),this._tracksById[e._id]=e},_createTrack(e){let t;const i=(0,c._)(e,this._unknownCount),s=i.label;if(this._unknownCount=i.unknownCount,this.renderNatively||"metadata"===e.kind){const i=this.video.textTracks;(t=(t=(0,r._e)(i,{label:s}))||this.video.addTextTrack(e.kind,s,e.language||"")).default=e.default,t.mode="disabled",t.inuse=!0}else(t=e).data=t.data||[];return t._id||(t._id=(0,c.M)(e,this._textTracks?this._textTracks.length:0)),t},_clearSideloadedTextTracks(){if(this._textTracks){var e=this._textTracks.filter(e=>e.embedded||"subs"===e.groupid);this._initTextTracks();const t=this._tracksById;e.forEach(e=>{t[e._id]=e}),this._textTracks=e}}}},5016:(e,t,i)=>{i.r(t),i.d(t,{default:()=>k});var h=i(1643),s=i(328),l=i(6042),u=i(4446);const a=class{constructor(e,t){this.chrome=(t||window).chrome,this.cast=(t||this).chrome.cast,this.Media=(t?t.chrome:this).cast.media,this.framework=(t||window).cast.framework,this.context=t?t.cast.framework.context:this.framework.CastContext.getInstance(),this.castSession=t?t.cast.framework.castSession:null,this.CAST_STATE_CHANGED=this.framework.CastContextEventType.CAST_STATE_CHANGED||null,this.appId=e||this.Media.DEFAULT_MEDIA_RECEIVER_APP_ID,this.updateCastState=this.updateCastState.bind(this),this.queueLoaded=this.queueLoaded.bind(this),this.mediaUpdate=this.mediaUpdate.bind(this)}init(){Object.assign(this,s.ZP),this.context.removeEventListener(this.CAST_STATE_CHANGED,this.updateCastState),this.context.addEventListener(this.CAST_STATE_CHANGED,this.updateCastState),this.context.setOptions({receiverApplicationId:this.appId,autoJoinPolicy:this.cast.AutoJoinPolicy.ORIGIN_SCOPED})}setPlaylist(s){var a=s.get("playlist");let r=s.get("item"),n=s.mediaModel.get("currentTime");const d=s.get("repeat"),o=s.get("captions"),e=this.castSession?this.castSession.getSessionObj():null;if("complete"===s.get("state")&&(r=0,n=0),1!==a.length||s.get("related")){var c,l=[];let t=1,i=0;1===a.length&&s.get("related")&&s.get("recItems")&&s.get("recItems").length&&a.push(...s.get("recItems"));for(let e=r;e<a.length;e++){const h=a[e],d=this.getMediaInfo(h,e,o);if(d){c=new this.Media.QueueItem(d),d.metadata.index===r&&(c.startTime=n,i=l.length);const s=JSON.stringify(c).length+1;if(!(t+s<32e3))break;l.push(c),t+=s}}if(l.length){const s=new this.Media.QueueLoadRequest(l);s.startIndex=i,d&&(s.repeatMode=this.Media.RepeatMode.ALL),e.queueLoad(s,this.queueLoaded,this.queueErrored)}else this.trigger(h.cM,new u.rG(null,35e4,{info:"media not supported by Chromecast"}))}else{const s=this.getMediaInfo(a[r],r,o),h=new this.Media.LoadRequest(s);h.autoplay=!0,h.currentTime=n,e.loadMedia(h,this.loaded,this.error)}}queueLoaded(e){this.loaded(e)}queueErrored(e){this.error(e)}getPlayerId(){var e=this.getMedia();return null!=e&&e.media?e.media.metadata.playerId:this.castSession?this.castSession.getSessionObj().playerId:null}setPlayerId(e){this.castSession&&(this.castSession.getSessionObj().playerId=e)}loaded(e){this.trigger("mediaUpdate",{field:"volume",value:{volume:this.castSession.getVolume(),isMute:this.castSession.isMute()}}),this.mediaAdded(e),this.play()}addListeners(){if(!this.castSession)return null;var e=this.castSession.getSessionObj();e.removeUpdateListener(this.updateCastState),e.addUpdateListener(this.updateCastState),e.removeMediaListener(this.mediaAdded),e.addMediaListener(this.mediaAdded),this.castSession.addEventListener(this.framework.SessionEventType.VOLUME_CHANGED,e=>{this.trigger("mediaUpdate",{field:"volume",value:e})})}reset(){this.removeListeners(),this.context&&this.context.removeEventListener(this.CAST_STATE_CHANGED,this.updateCastState)}removeListeners(){var e;this.castSession&&((e=this.castSession.getSessionObj()).removeUpdateListener(this.updateCastState),e.media.forEach(e=>{e.removeUpdateListener(this.mediaUpdate)}),this.castSession.removeEventListener(this.framework.SessionEventType.VOLUME_CHANGED))}getMedia(){if(this.castSession){var e=this.castSession.getSessionObj().media;if(null!=e&&e.length)return e[0]}return null}error(e){this.trigger(h.cM,new u.rG(null,35e4,{errorCode:e})),this.disconnect()}item(e){var t=this.getMedia();if(t){const i=this.getMediaInfo(e),s=(0,l.sE)(t.items,function(e){return e.media.contentId===i.contentId&&e.media.index===i.index});s?t.queueJumpToItem(s.itemId):this.trigger("setPlaylist")}else this.trigger("setPlaylist")}play(){var e=this.getMedia();e&&e.play()}pause(){var e=this.getMedia();e&&e.pause()}next(){var e=this.getMedia();e&&e.queueNext()}disconnect(){this.castSession&&this.castSession.endSession(!0)}seek(e,t){var i,s=this.getMedia();s&&((i=new this.Media.SeekRequest).currentTime=e,i.resumeState=this.Media.ResumeState.PLAYBACK_START,s.seek(i,t))}mute(e){this.castSession&&this.castSession.setMute(e)}volume(e){this.castSession&&!this.castSession.isMute()&&this.castSession.setVolume(e/100)}editTracksInfo(e,t){var i=this.getMedia();i&&(e=new this.Media.EditTracksInfoRequest(e,t),i.editTracksInfo(e))}extractEmbeddedCaptions(){var e=this.getMedia();if(e&&e.media.tracks){const t=/\.dfxp/,i=e.media.tracks.filter(e=>"TEXT"===e.type&&"side-loaded captions"!==e.customData&&!t.test(e.trackContentId)).map((e,t)=>(e.mapId=t,e.kind="subtitles",e.cues=[],e));i.length&&this.trigger("mediaUpdate",{field:"captions",value:{tracks:i}})}}getMediaInfo(e,t,i){let s=e.sources;e.allSources&&(s=e.allSources.slice(0).sort(function(e,t){return!e.default&&t.default?1:0}));var a,r,n,d,o,c=(0,l.sE)(s,function(e){var t=!(0,l.dp)(e.mediaTypes)||!(0,l.r3)(e.mediaTypes,'video/webm; codecs="vp9"'),e=!(0,l.dp)(e.drm)||(0,l.Yj)(e.drm,function(e,t){return"fairplay"!==t});return t&&e});if(c)return a=this.getMimeType(c.type),n=this.getAbsolutePathWithProtocol(c.file),r=e.image?this.getAbsolutePathWithProtocol(e.image):null,c=c.drm,d=e.duration||null,(n=new this.Media.MediaInfo(n,a)).streamType=!d||d<0||d===1/0?"LIVE":"BUFFERED",n.metadata=new this.Media.GenericMediaMetadata,n.metadata.title=e.title,n.metadata.subtitle=e.description,n.metadata.index=t||0,n.metadata.playerId=this.getPlayerId(),null!=e&&null!=(a=e.tracks)&&a.length&&(n.tracks=(d=e.tracks,o=this.Media,d.filter(e=>e.kind&&Boolean(o.TextTrackType[e.kind.toUpperCase()])).map((e,t)=>{var t=t+1,i=new o.Track(t,o.TrackType.TEXT),t=(i.trackContentId=e.file,i.trackContentType="text/vtt",i.name=e.label||t,i.subtype=o.TextTrackType[e.kind.toUpperCase()]);return t!==o.TextTrackType.CAPTIONS&&t!==o.TextTrackType.SUBTITLES&&t!==o.TextTrackType.DESCRIPTION||(i.customData="side-loaded captions",i.language="en-US"),i}))),i&&(n.textTrackStyle=this.obtainTrackStyles(i)),r&&(n.metadata.images=[{url:r}]),c&&(n.customData={drm:c}),n}obtainTrackStyles(e){function t(e){return Math.round(e/100*255).toString(16)}var i=new this.Media.TextTrackStyle,s=(e,t)=>e&&e+t||void 0;return i.foregroundColor=s(e.color,t(e.fontOpacity)),i.backgroundColor=s(e.backgroundColor,t(e.backgroundOpacity)),i.windowColor=s(e.windowColor,t(e.windowOpacity)),i.fontFamily=e.fontFamily,i.fontStyle=this.Media.TextTrackFontStyle.NORMAL,i.fontScale=e.fontSize/14,i.edgeType=function(e,t){var i=t.TextTrackEdgeType;switch(e){case"dropShadow":return i.DROP_SHADOW;case"raised":return i.RAISED;case"depressed":return i.DEPRESSED;case"uniform":return i.OUTLINE;default:return i.NONE}}(e.edgeStyle,this.Media),i.windowType=this.Media.TextTrackWindowType.NORMAL,i}getAbsolutePathWithProtocol(e){var t=document.createElement("a");return t.href=e,t.href}getMimeType(e){switch(e){case"mp4":case"webm":return"video/"+e;case"mpd":case"dash":return"application/dash+xml";case"m3u8":case"hls":return"application/x-mpegURL";case"aac":return"audio/x-aac";case"mp3":return"audio/mpeg";default:return e}}updateCastState(){var e=this.context.getCastState()!==this.framework.CastState.NO_DEVICES_AVAILABLE;let t="";this.castSession=this.context.getCurrentSession(),this.castSession&&(t=this.castSession.getCastDevice().friendlyName||t),this.trigger("castState",{available:e,active:Boolean(this.castSession),deviceName:t})}mediaUpdate(){var e=this.getMedia();e&&this.trigger("mediaUpdate",{field:"media",value:e})}mediaAdded(e){e.removeUpdateListener(this.mediaUpdate),e.addUpdateListener(this.mediaUpdate)}};var r=i(2799),n=i(686),t=i(6528),d=i(3328);class o{}Object.assign(o.prototype,t.Z,s.ZP,d.Z,{getName:()=>({name:"chromecast"}),getQualityLevels:(0,l.a9)(["Auto"])});const c=class extends o{constructor(e,t){super(),this.playerId=e,this.playerConfig=t,this.minDvrWindow=t.minDvrWindow,this.backgroundImage=null}castEventHandlers(e){const r={media:e=>{var t=this.getRemote("items"),i="IDLE"===e.playerState&&"FINISHED"===e.idleReason,s="IDLE"===e.playerState&&"ERROR"===e.idleReason,a=i&&!t;r.playerState(a?"complete":e.playerState),r.currentTime(),clearInterval(this.timeInterval),"PLAYING"===e.playerState?this.timeInterval=setInterval(r.currentTime,100):i?this.setState("itemComplete"):a?this.setState("complete"):s&&(this.setState("error"),this.trigger(h.cM,new u.rG(null,35e4,e)),t||this.castService.disconnect())},volume:e=>{this.trigger("volume",{volume:Math.round(100*e.volume)}),this.trigger("mute",{mute:e.isMute})},captions:e=>{this.clearTracks(),this.setTextTracks(e.tracks),this.trigger("subtitlesTracks",{tracks:e.tracks})},playerState:e=>{var t=[h.Kb,h.bc,h.r0,h._5,h.nQ,h.ik,h.xQ,h.Vy];if(e&&-1!==t.indexOf(e.toLowerCase())){t=e.toLowerCase();if(t===h.bc||t===h.Kb){const e=this.getRemote("currentTime");(0,l.hj)(e)&&this.trigger(h.uT,{bufferPercent:0,position:this.getPosition(),duration:this.getDuration(),currentTime:e,seekRange:this.getSeekRange()})}this.setState(t)}},currentTime:this.triggerTime.bind(this),duration:this.triggerTime.bind(this),isPaused:e=>{e?this.setState(h._5):this.setState(h.r0)},supports:()=>!0};return r[e]||null}destroy(){clearInterval(this.timeInterval)}setService(e){this.castService=e,this.updateScreen()}setup(e){this.setState(h.Kb),this.sendCommand("setup",e)}init(e){this.currentItem!==e&&(this.currentItem=e,this.sendCommand("item",e))}load(e){this.init(e),this.play()}play(){this.sendCommand("play")}pause(){this.sendCommand("pause")}seek(e){const t=this.getRemote("currentTime");if(this.trigger(h.NZ,{position:this.getPosition(),offset:e,duration:this.getDuration(),currentTime:t,seekRange:this.getSeekRange(),metadata:{currentTime:t}}),e<0){const t=this.getSeekRange()["end"];e+=t}this.sendCommand("seek",e,()=>{this.trigger(h.aQ)})}next(e){this.sendCommand("next",e)}volume(e){this.sendCommand("volume",e)}mute(e){this.sendCommand("mute",e)}setSubtitlesTrack(e){e=0<e?[e+this.minimumEmbeddedTrackId()]:[];this.castService.editTracksInfo(e)}minimumEmbeddedTrackId(){var t=window.chrome.cast.media.TextTrackType,e=(t.CAPTION="CAPTION",t.SUBTITLE="SUBTITLE",this.castService.getMedia());let i=0;if(e){var s=e.media.tracks;if(s)for(let e=0;e<s.length;e++){var a=s[e],r=a.subtype;if("TEXT"===a.type&&(r===t.CAPTIONS||r===t.SUBTITLES||r===t.DESCRIPTIONS||r===t.CAPTION||r===t.SUBTITLE||"text/vtt"===a.trackContentType)){i=e;break}}}return i}sendCommand(e,...t){this.castService&&this.castService[e]&&this.castService[e](...t)}getRemote(e){var t;if(this.castService)return(t=this.castService.getMedia())?"currentTime"!==e||t.liveSeekableRange?t[e]||(t.media?t.media[e]:null):t.getEstimatedTime():null}updateScreen(e,t){this.backgroundImage!==t&&(this.backgroundImage=t,this.statusMessage=e,(0,r.nh)(this.container,`<div class="jw-cast jw-reset jw-preview" style="${t?`background-image:url('${t}')`:""}">
      <div class="jw-cast-container">
        <div class="jw-cast-text jw-reset">
          ${e||""}
        </div>
      </div>
    </div>`))}getContainer(){return this.container}setContainer(e){this.container=e}remove(){this.statusMessage=null,clearInterval(this.timeInterval)}getPosition(){const e=this.getRemote("currentTime")||0,t=this.getDuration();if(this.getRemote("liveSeekableRange")&&t<0){const{end:t,start:i}=this.getSeekRange(),s=t-i;if((0,n.s)(s,this.minDvrWindow))return e-t}return e}getDuration(){const e=this.getRemote("duration")||0;if(this.getRemote("liveSeekableRange")&&e<0){const{end:e,start:t}=this.getSeekRange(),i=e-t;return(0,n.s)(i,this.minDvrWindow)?-i:1/0}return e}getSeekRange(){var{start:e,end:t}=this.getRemote("liveSeekableRange")||{start:0,end:Math.max(this.getRemote("duration")||0,0)};return{start:e,end:t}}triggerTime(){var e=this.getRemote("currentTime");(0,l.hj)(e)&&this.trigger(h.R2,{position:this.getPosition(),duration:this.getDuration(),currentTime:e,seekRange:this.getSeekRange(),metadata:{currentTime:e}})}stop(){this.clearTracks()}};var m=i(676);let T;var v=i(4429);const g={},k=class{constructor(e,t,i){this.stopCasting=()=>{var e;return(null==this||null==(e=this.service)||null==e.disconnect?void 0:e.disconnect())||v.Z.noop},this.localController=e,this.model=t,this.service=g[this.model.get("id")]||null,this.castProvider=null,this.castToggle=v.Z.noop,this.setup=this.setup.bind(this),this.options=i||{},this.loadingApi=T||(T=new Promise(function(t,i){window.__onGCastApiAvailable=function(e){e?t(e):i(),delete window.__onGCastApiAvailable},new m.ZP("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1").load().catch(i)}))}init(){return this.loadingApi.then(this.setup)}setup(){var e=this.model.get("cast")||{},t=(this.model.set("castState",{available:!1,active:!1,deviceName:""}),this.service&&(this.service.off(),this.service.reset()),this.options&&(this.options.CastService||a));this.service=new t(e.appid||e.customAppId),this.service.init(),this.service.on("castState",this.updateCastState,this),this.service.on("mediaUpdate",this.onMediaUpdate,this),this.service.on("mediaUpdate",this.onFirstMediaUpdate,this),this.service.on("setPlaylist",this.setPlaylist,this),this.service.on(h.cM,e=>{this.localController.trigger(h.cM,e)}),this.service.updateCastState(),g[this.model.get("id")]=this.service}switchProviders(){var e=this.options&&(this.options.CastProvider||c);this.castProvider=new e(this.model.get("id"),this.model.getConfiguration()),this.localController.castVideo(this.castProvider,this.model.get("playlistItem")),this.castProvider.setService(this.service)}setPlaylist(){this.model.set("state",h.Kb),this.castProvider.updateScreen("Connecting",this.model.get("playlistItem").image),this.service.setPlaylist(this.model)}onConnect(){var e=this.model.get("castClicked");!e&&this.service.getPlayerId()||this.service.setPlayerId(this.model.get("id")),e&&this.isActivePlayer()&&(this.localController.setFullscreen(!1),this.switchProviders(),this.service.addListeners(),(e=this.service.getMedia())?this.service.loaded(e):(this.service.on("mediaUpdate",this.seekToEdgeIfDvr,this),this.setPlaylist()),this.model.on("change:playlist",this.setPlaylist,this),this.model.on("change:itemReady",this.checkForEmbeddedCaptions,this),this.model.change("captions",this.updateCaptionStyles,this))}onDisconnect(){const t=this.model.get("state");let i=t===h.xQ;var e=t===h.bc,s=t===h.Vy,a=this.model.get("item"),r=this.model.get("playlist");let n=this.model.get("playlistItem");if(this.service.removeListeners(),this.castProvider&&this.castProvider.remove(),n&&s&&(void 0===(n=r[a+1])?i=!0:(this.model.set("item",a+1),this.model.set("playlistItem",n))),this.model.set("castActive",!1),this.model.set("castClicked",!1),this.localController.stopCast(),this.model.off(null,null,this),n)if(i)this.localController.trigger(h.V$,{});else if(!e){const t=this.model.mediaModel,i=this.castProvider;this.localController.playVideo("interaction").catch(function(e){i&&t&&i.trigger("error",{message:e.message})})}}toggleConnection(e){e?this.onConnect():this.castProvider&&this.onDisconnect()}checkForEmbeddedCaptions(){this.service.extractEmbeddedCaptions(),this.castProvider.setSubtitlesTrack(this.model.get("captionsIndex"))}updateCaptionStyles(e,t){var i=this.service.getMedia();i&&(t=this.service.obtainTrackStyles(t),this.service.editTracksInfo(i.activeTrackIds,t))}onMediaUpdate(e){var t=e.field,e=e.value;this.castProvider&&("media"===t&&this.updatePlaylistItem(e),t=this.castProvider.castEventHandlers(t))&&t(e)}onFirstMediaUpdate(e){"media"===e.field&&(this.checkForEmbeddedCaptions(),this.service.off("mediaUpdate",this.onFirstMediaUpdate,this))}seekToEdgeIfDvr(e){if("media"===e.field){this.service.off("mediaUpdate",this.seekToEdgeIfDvr,this);const t=e.value,{currentTime:i,liveSeekableRange:s}=t;if(!i&&s){const{start:e,end:t}=s;if(!this.model.mediaModel.get("currentTime")&&(0,n.s)(t-e,this.model.get("minDvrWindow"))){const e=t-this.model.get("dvrSeekLimit");this.service.seek(e)}}}}updatePlaylistItem(e){var t,i=this.model.get("playlist");e.media&&(t=i[(i=e.media.metadata).index],(0,l.hj)(i.index))&&i.index!==this.model.get("item")&&(this.model.attributes.itemReady=!1,this.model.set("item",i.index),this.model.set("itemReady",!0),e.idleReason||this.model.set("playlistItem",t),this.castProvider.updateScreen("Updating Playlist Item",t.image),"itemComplete"===this.castProvider.state)&&this.model.get("playlistItemCallback")&&this.castProvider.sendCommand("item",t)}updateCastState(e){var t=this.model.get("castActive"),i=e.active;t!==i&&this.toggleConnection(i),i=i&&this.isActivePlayer(),this.model.set("castAvailable",e.available),this.model.set("castActive",i),this.model.set("castState",{available:e.available,active:i,deviceName:e.deviceName})}isActivePlayer(){return this.service.getPlayerId()===this.model.get("id")}}}}]);